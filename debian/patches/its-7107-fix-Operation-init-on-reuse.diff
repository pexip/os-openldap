From 85c1c545f4e20882a2f748fcef5f732ea2d2ecf6 Mon Sep 17 00:00:00 2001
From: Howard Chu <hyc@openldap.org>
Date: Tue, 13 Dec 2011 15:53:38 -0800
Subject: [PATCH] ITS#7107 fix Operation init on reuse

Additional fix for a66fb1630cc1134ed4e2a3d5a6a4983e6c4bae86
---
 servers/slapd/operation.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/servers/slapd/operation.c b/servers/slapd/operation.c
index 1d84d0c..946eb7c 100644
--- a/servers/slapd/operation.c
+++ b/servers/slapd/operation.c
@@ -129,6 +129,7 @@ slap_op_free( Operation *op, void *ctx )
 	op->o_bd = NULL;
 	BER_BVZERO( &op->o_req_dn );
 	BER_BVZERO( &op->o_req_ndn );
+	memset( op->o_hdr, 0, sizeof( *op->o_hdr ));
 	memset( &op->o_request, 0, sizeof( op->o_request ));
 	memset( &op->o_do_not_cache, 0, sizeof( Operation ) - offsetof( Operation, o_do_not_cache ));
 	memset( opbuf->ob_controls, 0, sizeof( opbuf->ob_controls ));
-- 
1.7.4.2

